<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Accessible ATM Prototype</title>
  <style>
    * { box-sizing: border-box; font-family: Arial, sans-serif; }
    body, html { margin: 0; padding: 0; height: 100%; background: #f0f0f0; }
    #atm { width: 360px; margin: 40px auto; border: 2px solid #333; border-radius: 8px; background: #222; color: #fff; overflow: hidden; }
    #screen { position: relative; width: 100%; height: 400px; background: #000; display: flex; flex-direction: column; align-items: center; justify-content: center; }
    #figure { width: 120px; height: 120px; background: #555; border-radius: 50%; margin-bottom: 10px; display: flex; align-items: center; justify-content: center; color: #fff; font-size: 48px; }
    #message { font-size: 1.2rem; text-align: center; margin: 5px; }
    #subtitles { position: absolute; bottom: 10px; width: 90%; font-size: 0.9rem; text-align: center; color: #0f0; }
    .btn { padding: 10px 20px; margin: 10px; border: none; border-radius: 4px; background: #444; color: #fff; cursor: pointer; }
    .btn:hover { background: #666; }
    #pin-entry { display: none; flex-direction: column; align-items: center; }
    #pin { width: 140px; font-size: 1.5rem; text-align: center; letter-spacing: 0.3rem; padding: 5px; margin-bottom: 10px; }
    #keypad { display: grid; grid-template-columns: repeat(3, 60px); grid-gap: 10px; }
    .key { width: 60px; height: 60px; font-size: 1.2rem; background: #444; border: none; border-radius: 4px; color: #fff; cursor: pointer; }
    .highlight { outline: 3px solid #0f0; }
    #card-slot, #cash-slot { width: 100%; background: #111; text-align: center; line-height: 50px; }
    #cash-slot { height: 80px; position: relative; }
    .cash { width: 80px; height: 40px; background: #0a0; position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); display: none; }
    @keyframes rise { from { bottom: 10px; opacity: 0; } to { bottom: 100px; opacity: 1; } }
  </style>
</head>
<body>
  <div id="atm">
    <div id="screen">
      <div id="figure">ü§ñ</div>
      <div id="message">Select Mode</div>
      <div id="controls">
        <button class="btn" id="elderlyMode">Elderly</button>
        <button class="btn" id="visuallyMode">Visually Impaired</button>
      </div>
      <div id="subtitles"></div>
      <div id="pin-entry">
        <input type="password" id="pin" maxlength="4" readonly />
        <div id="keypad"></div>
      </div>
    </div>
    <div id="card-slot">Card Slot</div>
    <div id="cash-slot"><div class="cash"></div></div>
  </div>

  <script>
    const figure = document.getElementById('figure');
    const message = document.getElementById('message');
    const subtitles = document.getElementById('subtitles');
    const controls = document.getElementById('controls');
    const pinEntry = document.getElementById('pin-entry');
    const pinInput = document.getElementById('pin');
    const keypad = document.getElementById('keypad');
    const cardSlot = document.getElementById('card-slot');
    const cashSlot = document.querySelector('#cash-slot .cash');
    const screen = document.getElementById('screen');

    let mode = null;
    let pinValue = '';

    // Create keypad buttons
    for (let i = 1; i <= 9; i++) addKey(i);
    addKey('‚Üê'); addKey(0); addKey('‚úî');

    function addKey(label) {
      const btn = document.createElement('button');
      btn.textContent = label;
      btn.className = 'key';
      btn.onclick = () => handleKey(label);
      keypad.appendChild(btn);
    }

    document.getElementById('elderlyMode').onclick = () => startElderly();
    document.getElementById('visuallyMode').onclick = () => startVisually();

    function speak(text) {
      const utter = new SpeechSynthesisUtterance(text);
      speechSynthesis.speak(utter);
    }

    function startElderly() {
      mode = 'elderly';
      controls.style.display = 'none';
      message.textContent = 'Machine sensing presence...';
      subtitles.textContent = '';
      setTimeout(() => {
        message.textContent = 'Hello Edna, how can I help you?';
        subtitles.textContent = 'Hello Edna, how can I help you?';
        controls.innerHTML = '';
        const withdrawBtn = document.createElement('button');
        withdrawBtn.textContent = 'Withdraw Cash'; withdrawBtn.className = 'btn';
        withdrawBtn.onclick = () => requestPin();
        controls.appendChild(withdrawBtn);
        controls.style.display = 'block';
      }, 2000);
    }

    function requestPin() {
      controls.style.display = 'none';
      message.textContent = 'Please enter your PIN';
      subtitles.textContent = '';
      pinEntry.style.display = 'flex';
    }

    function handleKey(label) {
      if (label === '‚Üê') {
        pinValue = pinValue.slice(0, -1);
      } else if (label === '‚úî') {
        if (pinValue.length === 4) confirmPin();
        return;
      } else {
        if (pinValue.length < 4) pinValue += label;
      }
      pinInput.value = '*'.repeat(pinValue.length);
    }

    function confirmPin() {
      message.textContent = 'PIN accepted. Please wait...';
      subtitles.textContent = 'PIN accepted. Please wait...';
      setTimeout(() => dispenseCash(), 1500);
    }

    function dispenseCash() {
      pinEntry.style.display = 'none';
      message.textContent = 'Dispensing cash...';
      subtitles.textContent = 'Dispensing cash...';
      cashSlot.style.display = 'block';
      cashSlot.style.animation = 'rise 2s ease-out forwards';
      setTimeout(() => {
        message.textContent = 'Thank you!';
        subtitles.textContent = 'Thank you!';
      }, 3000);
    }

    function startVisually() {
      mode = 'visually';
      controls.style.display = 'none';
      message.textContent = 'Press screen to begin';
      subtitles.textContent = '';
      screen.addEventListener('click', visStep1, { once: true });
    }

    function visStep1() {
      speak('Please insert your debit card.');
      subtitles.textContent = 'Please insert your debit card.';
      cardSlot.classList.add('highlight');
      cardSlot.onclick = visStep2;
    }

    function visStep2() {
      cardSlot.classList.remove('highlight');
      speak('Card received, please enter your PIN.');
      subtitles.textContent = 'Card received, please enter your PIN.';
      requestPin();
    }
  </script>
</body>
</html>
